<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Biblioteca de PDFs</title>

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<!-- Google Font Bold -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@700&display=swap" rel="stylesheet">
<!-- Lucide Icons -->
<script src="https://unpkg.com/lucide@latest"></script>

<!-- Manifest PWA -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#4f46e5">

<style>
body { font-family: 'Inter', sans-serif; background:#f8f9fa; }
.pdf-list-item { display:flex; gap:16px; align-items:flex-start; margin-bottom:20px; background:#fff; border-radius:12px; padding:12px; box-shadow:0 4px 12px rgba(0,0,0,0.08); transition:transform 0.2s; flex-wrap:wrap; }
.pdf-list-item:hover { transform: translateY(-3px); }
.pdf-list-image { width:160px; height:120px; object-fit:cover; border-radius:8px; cursor:pointer; flex-shrink:0; }
.pdf-list-content { flex:1; display:flex; flex-direction:column; min-width:0; }
.pdf-list-title { font-size:1.2rem; font-weight:700; margin-bottom:4px; }
.pdf-list-description { font-size:0.9rem; color:#6c757d; margin-bottom:6px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
.pdf-list-badges span { margin-right:4px; font-size:0.8rem; }
.pdf-list-footer { display:flex; justify-content:space-between; align-items:center; margin-top:auto; flex-wrap:wrap; }
.pdf-list-buttons a { margin-right:6px; margin-top:4px; }
.sticky-search { position:sticky; top:0; z-index:1020; background:#f8f9fa; padding:1rem 0; margin-bottom:20px; }
.search-input { border-radius:14px; padding:12px 16px; font-size:1rem; }
@media(max-width:576px){.pdf-list-item{flex-direction:column;}.pdf-list-image{width:100%;height:auto;}} 
</style>
</head>
<body>

<div class="container py-4">
<h1 class="text-center mb-4" style="font-size:2rem; background:linear-gradient(90deg,#4f46e5,#3b82f6,#06b6d4); -webkit-background-clip:text; -webkit-text-fill-color:transparent;">Biblioteca de PDFs</h1>

<div class="sticky-search">
  <input type="text" id="search" class="form-control search-input" placeholder=" Pesquisar PDF...">
</div>

<div id="lista"></div>
</div>

<!-- Modal Fullscreen de Imagens -->
<div class="modal fade" id="imageModal" tabindex="-1">
  <div class="modal-dialog modal-fullscreen">
    <div class="modal-content bg-dark">
      <div class="modal-header border-0">
        <h5 class="modal-title text-white">Pré-visualizações</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body overflow-auto text-center" id="imageModalContent"></div>
    </div>
  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
class TrackingSystem {
  constructor(){console.log('Sistema de rastreamento iniciado');}
  trackDownload(pdfId,pdfName){console.log(`Download: ${pdfName} (ID: ${pdfId})`);}
  trackPreview(pdfId,pdfName){console.log(`Preview: ${pdfName} (ID: ${pdfId})`);}
}
const tracker = new TrackingSystem();

async function loadPDFs(){
  const container = document.getElementById('lista');
  try{
    const response=await fetch('pdf.json');
    const pdfs=await response.json();
    const searchInput=document.getElementById('search');

    function renderPDFs(filter=''){
      container.innerHTML='';
      const filtered=pdfs.filter(pdf=>!filter||(pdf.nome&&pdf.nome.toLowerCase().includes(filter.toLowerCase())));
      if(filtered.length===0){container.innerHTML='<div class="text-center py-5">Nenhum PDF encontrado</div>'; return;}

      filtered.forEach(pdf=>{
        const div=document.createElement('div');
        div.className='pdf-list-item';
        div.innerHTML=`
          <img src="${pdf.previas&&pdf.previas.length>0?pdf.previas[0]:''}" class="pdf-list-image" onclick='openImageModal(${JSON.stringify(pdf.previas||[])})'>
          <div class="pdf-list-content">
            <div class="pdf-list-title">${pdf.nome||'Sem título'}</div>
            <div class="pdf-list-description">${pdf.descricao||'Sem descrição'}</div>
            <div class="pdf-list-badges">
              <span class="badge bg-primary">${pdf.categoria||'Geral'}</span>
              ${pdf.gratis?'<span class="badge bg-success">Gratuito</span>':'<span class="badge bg-warning">Pago</span>'}
              ${pdf.tags?pdf.tags.split(',').map(tag=>`<span class="badge bg-secondary">${tag.trim()}</span>`).join(''):''}
            </div>
            <div class="pdf-list-footer">
              <div class="text-muted">${pdf.data||'Data não informada'}</div>
              <div class="pdf-list-buttons">
                <a href="#" class="btn btn-primary btn-sm" onclick="openImageModal(${JSON.stringify(pdf.previas||[])})"><i data-lucide="eye"></i></a>
                <a href="${pdf.url}" download class="btn btn-success btn-sm" onclick="tracker.trackDownload(${pdf.id}, '${pdf.nome}')"><i data-lucide="download"></i></a>
              </div>
            </div>
          </div>
        `;
        container.appendChild(div);
      });
      lucide.createIcons();
    }

    renderPDFs();
    searchInput.addEventListener('input',()=>renderPDFs(searchInput.value));
  }catch(e){
    console.error(e);
    container.innerHTML='<div class="text-center py-5">Erro ao carregar PDFs</div>';
  }
}
document.addEventListener('DOMContentLoaded', loadPDFs);

function openImageModal(images=[]){
  const container=document.getElementById('imageModalContent');
  container.innerHTML='';
  images.forEach(img=>{
    const image=document.createElement('img');
    image.src=img; image.className='img-fluid mb-4 rounded';
    container.appendChild(image);
  });
  new bootstrap.Modal(document.getElementById('imageModal')).show();
}
</script>

<footer class="text-center py-4 mt-5" style="background:#f8f9fa; color:#6c757d; font-size:13px; border-top:1px solid #dee2e6; border-radius:12px 12px 0 0;">
  © 2026 Biblioteca de PDFs | <a href="licenca.html" style="color:#0d6efd; text-decoration:none;">Políticas & Privacidade</a>
</footer>

</body>
</html>
